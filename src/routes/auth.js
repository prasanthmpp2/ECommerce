const express = require('express');\nconst bcrypt = require('bcrypt');\nconst jwt = require('jsonwebtoken');\n\nmodule.exports = (prisma) => {\n  const router = express.Router();\n\n  router.post('/login', async (req, res) => {\n    const { email, password } = req.body;\n    if (!email || !password) return res.status(400).json({ error: 'Missing credentials' });\n\n    const user = await prisma.user.findUnique({ where: { email }});\n    if (!user) return res.status(401).json({ error: 'Invalid credentials' });\n\n    const ok = await bcrypt.compare(password, user.password);\n    if (!ok) return res.status(401).json({ error: 'Invalid credentials' });\n\n    const token = jwt.sign({ userId: user.id, role: user.role }, process.env.JWT_SECRET, { expiresIn: '8h' });\n\n    res.cookie('token', token, {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === 'production',\n      sameSite: 'lax',\n      maxAge: 8 * 60 * 60 * 1000\n    });\n\n    res.json({ message: 'Logged in', role: user.role });\n  });\n\n  router.post('/logout', (req, res) => {\n    res.clearCookie('token');\n    res.json({ message: 'Logged out' });\n  });\n\n  return router;\n};