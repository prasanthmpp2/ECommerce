const jwt = require('jsonwebtoken');\n\nfunction authenticate(req, res, next) {\n  const token = req.cookies?.token || req.header('Authorization')?.replace('Bearer ', '');\n  if (!token) return res.status(401).json({ error: 'Not authenticated' });\n\n  try {\n    const payload = jwt.verify(token, process.env.JWT_SECRET);\n    req.user = payload;\n    next();\n  } catch (err) {\n    return res.status(401).json({ error: 'Invalid token' });\n  }\n}\n\nfunction requireRole(role) {\n  return (req, res, next) => {\n    if (!req.user || req.user.role !== role) return res.status(403).json({ error: 'Forbidden' });\n    next();\n  };\n}\n\nmodule.exports = { authenticate, requireRole };