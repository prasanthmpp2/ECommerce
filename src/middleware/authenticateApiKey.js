module.exports = (prisma) => {\n  return async (req, res, next) => {\n    const key = req.header('x-api-key');\n    if (!key) return res.status(401).json({ error: 'Missing API key' });\n\n    const apiKey = await prisma.apiKey.findUnique({ where: { key }});\n    if (!apiKey || apiKey.revoked) return res.status(401).json({ error: 'Invalid API key' });\n\n    req.apiKey = apiKey;\n    next();\n  };\n};